# ğŸ§± 1.3.1 Falha de cluster / WSFC
**Categoria:** Infraestrutura  
**CI afetado:** Cluster Windows / WSFC / Availability Group  
**Escopo:** Alta Disponibilidade / NÃ³ do Cluster  
**Severidade sugerida:** P1  

---

## ğŸ¯ Objetivo

Identificar falhas em ambientes com Windows Server Failover Cluster (WSFC), validando estado dos nÃ³s, recursos e integraÃ§Ã£o com o SQL Server.

---

## ğŸ” DiagnÃ³stico Inicial (Quick Triage)

PowerShell:

```powershell
Get-ClusterNode
```
```powershell
Get-ClusterGroup
```

---

ğŸ§  **AnÃ¡lise por DMV**
- **Estado do Cluster via SQL Server**
```powershell
SELECT * FROM sys.dm_hadr_cluster;
```
Objetivo:

- Validar comunicaÃ§Ã£o do SQL Server com o cluster

##

- **Estado das RÃ©plicas (quando aplicÃ¡vel)**
```powershell
SELECT * FROM sys.dm_hadr_availability_replica_states;
```
Objetivo:

- Verificar sincronizaÃ§Ã£o das rÃ©plicas

---

ğŸ–¥ï¸ **Event Viewer (Sistema Operacional)**

Logs importantes:

- FailoverClustering
- System
- Application
<br>
Objetivo:

- Identificar eventos crÃ­ticos relacionados ao cluster

---

ğŸ§° **ScriptDBA / Ferramentas Opcionais**

Ferramentas recomendadas:

- Failover Cluster Manager
- SQL Server Management Studio (Dashboard Always On)

---

ğŸ§© **PossÃ­veis Causas**

- Perda de comunicaÃ§Ã£o entre nÃ³s
- Falha de rede
- Problemas no quorum
- ServiÃ§os do cluster parados
- AtualizaÃ§Ãµes recentes no sistema operacional

---

ğŸ› ï¸ **AÃ§Ãµes de MitigaÃ§Ã£o**

- Validar estado dos nÃ³s do cluster
- Verificar recursos offline
- Revisar configuraÃ§Ã£o de quorum
- Validar serviÃ§os do SQL Server e Cluster
- Analisar logs do Event Viewer

---

ğŸ” **Monitoramento PÃ³s-Mitigation**
```sql
SELECT * FROM sys.dm_hadr_cluster;
```
```powershell
Get-ClusterNode
```
