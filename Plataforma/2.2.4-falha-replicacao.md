# ğŸ“¡ 2.2.4 Falha de ReplicaÃ§Ã£o
**Categoria:** Plataforma SQL Server  
**CI afetado:** Publisher / Distributor / Subscriber  
**Escopo:** ReplicaÃ§Ã£o Transacional / Snapshot / Merge  
**Severidade sugerida:** P1 / P2  

---

## ğŸ¯ Objetivo

Identificar falhas de sincronizaÃ§Ã£o, atrasos ou erros em ambientes configurados com ReplicaÃ§Ã£o SQL Server, analisando agentes e estado da distribuiÃ§Ã£o.

---

## ğŸ” DiagnÃ³stico Inicial (Quick Triage)

```sql
SELECT * FROM msdb.dbo.MSdistribution_status;
```
```sql
SELECT *
FROM msdb.dbo.sysjobs
WHERE name LIKE '%Replication%';
```
---

ğŸ§  **AnÃ¡lise por Componentes**
- **Status dos Agentes**
```sql
SELECT 
    name,
    enabled
FROM msdb.dbo.sysjobs
WHERE name LIKE '%Agent%';
```
Objetivo:

- Confirmar se os agentes de Log Reader, Distribution ou Snapshot estÃ£o habilitados

##

- **Erros Recentes na ReplicaÃ§Ã£o**
```sql
SELECT TOP 20 *
FROM msdb.dbo.MSrepl_errors
ORDER BY time DESC;
```
Objetivo:

- Identificar erro raiz da falha

##

- **PendÃªncias na DistribuiÃ§Ã£o**
```sql
SELECT * FROM distribution.dbo.MSdistribution_status;
```
Objetivo:

- Verificar atraso entre Publisher e Subscriber

---

ğŸ–¥ï¸ **Monitoramento via SSMS**

Ferramenta:

- Replication Monitor
<br>
Objetivo:

- Visualizar latÃªncia e status dos agentes
- Identificar falhas recorrentes

---

ğŸ§© **PossÃ­veis Causas**

- Agente parado ou falhando
- Problema de conectividade
- Conflito de chave primÃ¡ria
- Timeout em distribuiÃ§Ã£o
- EspaÃ§o insuficiente no Distributor

---

ğŸ› ï¸ **AÃ§Ãµes de MitigaÃ§Ã£o**

- Reiniciar agente afetado
- Validar conectividade entre nÃ³s
- Revisar erro detalhado em MSrepl_errors
- Verificar espaÃ§o no banco distribution
- Reconfigurar assinatura (quando necessÃ¡rio)

---

ğŸ” **Monitoramento PÃ³s-Mitigation**
```sql
SELECT TOP 10 *
FROM msdb.dbo.MSrepl_errors
ORDER BY time DESC;
```
```sql
SELECT * FROM distribution.dbo.MSdistribution_status;
```
